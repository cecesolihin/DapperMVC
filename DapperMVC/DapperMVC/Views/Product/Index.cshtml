
@{
    ViewBag.Title = "Index";
}
<link href="~/Content/bootstrap 4.5.3/css/bootstrap.min.css" rel="stylesheet" />
<script src="~/Scripts/jquery-3.5.1/jquery-3.5.1.min.js"></script>
<script src="~/Content/bootstrap 4.5.3/js/bootstrap.bundle.js"></script>
<script src="~/Content/bootstrap 4.5.3/js/bootstrap.min.js"></script>
<link href="~/Content/bootstrap 4.5.3/css/font-awesome.min.css" rel="stylesheet" />
<script src="~/Scripts/popper.min.js"></script>
@Html.Partial("_SearchForm")
@Html.Partial("_Modal")
<div id="gridtable2">
    @Html.Partial("_GridView")
</div>
<script type="text/javascript">
    $(document).ready(function () {
        onSearch();
        
    });
    function btnSearch_onClick() {

        onSearch();
    }
    function onSearch() {
       
        var productId = $('#ProductId-search').val();
        var productName = $('#ProductName-search').val();
        //alert(productId);
        $.ajax({
            url: "/Product/Search",
            type: "GET",
           // contentType: "application/json;charset=utf-8",
            data: {
                ProductId: productId,
                ProductName: productName,
            },
            success: function (data) {
                //alert(data);
                console.log(data);
                $('#gridtable2').html(data);
            }
        });
    }
    
    function btnAdd_onClick() {
        $('.productId').hide();
        $('#btnsaveUpdate').hide();
        $('#ModalProduct').modal('show');
    }
    function getUpdatePopUp(id) {
        
        $.ajax({
            url: "/Product/ProductById",
            type: "GET",
            dataType: "Json",
            data: { productId:id },
            success: function (data) {
                $('#txtProductId').val(data.ProductId);
                $('#txtProductName').val(data.ProductName);
                $('#txtPrice').val(data.Price);

                $('.productId').show();
                $('#btnsaveUpdate').show();
                $('#btnsaveAdd').hide();
                $('#ModalProduct').modal('show');
            }
        });

    }
    function getDetailPopup(productId) {
        var productId = $('#btnDetail').attr('attr-productid');
        alert('getDetailPopup ' + productId);
    }
    function getDeletePopUp(id) {
       

        $.ajax({
            url: "/Product/ProductById",
            type: "GET",
            dataType: "Json",
            data: { productId:id },
            success: function (data) {
                $('#delProductId').val(data.ProductId);
                $('#delProductName').val(data.ProductName);
                $('#delPrice').val(data.Price);

                $('#ModalDeleteProduct').modal('show');
            }
        });

    }
    function OnCancel_click() {
        $('#txtProductName').val('');
        $('#txtPrice').val('');
        $('#ModalProduct').modal('hide');
    }
    function OnSave_click(action) {
        
        var obj = {};
        obj.ProductId = $('#txtProductId').val();
        obj.ProductName = $('#txtProductName').val();
        obj.Price = $('#txtPrice').val();
      
        if (action=='ADD') {
            $.ajax({
                url: "/Product/Create",
                type: "POST",
                data: obj,
                success: function (result) {
                    //console.log(responseMessage);
                    $('#ModalProduct').modal('hide');
                    if (result=='success') {
                        onSearch();
                    }
                    
                },
                error: function (result) {
                   // console.log(responseMessage);
                    //var mssg = 'ERROR : ' + responseMessage.status + '\n' + responseMessage.responseJSON;
                    alert(result);
                }
            });
        }
        else {
            $.ajax({
                url: "/Product/Update",
                type: "POST",
                data: obj,
                success: function (result) {
                    //console.log(responseMessage);
                    $('#ModalProduct').modal('hide');
                    if (result == 'success') {
                        onSearch();
                    }
                },
                error: function (result) {
                    console.log(result);
                    //var mssg = 'ERROR : ' + responseMessage.status + '\n' + responseMessage.responseJSON;
                   alert(result);
                }
            });
        }
    }
    function OnDelete_click() {
        var productId =$('#delProductId').val();
        if (confirm('Are you sure to delete this item data')) {
            //alert(productId);
            $.ajax({
                url: "/Product/DeleteProduct",
                type: "POST",
               // dataType: "Json",
                data: { productId: productId },
                success: function (result) {
                    
                    $('#ModalDeleteProduct').modal('hide');
                    if (result == 'success') {
                        onSearch();
                    }
                },
                error: function (result) {
                    console.log(result);
                    //var mssg = 'ERROR : ' + responseMessage.status + '\n' + responseMessage.responseJSON;
                    alert(result);
                }
            });
        }
    }
    function OnCancelDelete_click() {
        $('#ModalDeleteProduct').modal('hide');
    }
    function btnClear_onClick() {
        $('#ProductId-search').val('');
        $('#ProductName-search').val('');
        onSearch();
    }
</script>

